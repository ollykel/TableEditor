# Table Editor

Hate how Google Docs can't handle tables with more than five columns? Find it
clunky when you have create a text-based spreadsheet in Google Sheets? Hate it
when two people try to edit the same thing at the same time? This table editor
is the solution for you.

## Setup

### Dependencies

The sole dependency needed to run this program is Docker. See
[docs.docker.com](https://docs.docker.com/desktop/) for instructions on
installing Docker Desktop on your computer.

### Environment Configuration

To configure the Table Editor, you need a .env file in the repository root. A
file named example.env has been provided to get you started. To start, simply
copy example.env to .env.

```
cp ./example.env ./.env
```

Edit your .env file to set the values of the required fields, which are
commented out and marked TODO. The required fields are:

- POSTGRES\_PASSWORD: The admin password for the PostgreSQL database. NOTE:
  to change the database password after initialization, you will need to change
  the password both here and by manually changing the password in the database
  container.
- JWT\_SECRET: The signing secret for JWT authentication tokens generated by the
  REST API. Should be a random string at least 64 characters in length.

### HTTPS Configuration

For the nginx https server to work, you'll need a private key file and a
certificate file. These should be placed in the following locations:

- key file: ReverseProxy/key.pem
- certificate file: ReverseProxy/cert.pem

For testing purposes, it will be sufficient to use a self-signed certificate. To
generate your own private key and self-signed certificate using openssl, run the
following commands:

Generate private key:

```
openssl genrsa -out ReverseProxy/key.pem 2048
```

Generate certificate signing request:

```
openssl req -key ReverseProxy/key.pem -new -out ReverseProxy/cert.csr
```

Generate a signed certificate using your own private key, with a ten day
expiration period:

```
openssl x509 -signkey ReverseProxy/key.pem -in ReverseProxy/cert.csr -req -days 10 -out ReverseProxy/cert.pem
```

(You may change the days argument to however long you would like the certificate
to remain valid).

### Building and Running

One you have docker installed, you can start the app by running the following
command from the repository root:

```
docker compose up --build -d
```

In order to read the logs from any of the services that make up the table
editor, simply run the following command:

```
docker compose logs <service_name>
```

The names of the services (i.e. reverse\_proxy, rest\_api, etc.) are given in
docker-compose.yml.

Building the necessary images can be resource intensive. You should have at
least 10G of free space on your device before you run the Table Editor.

Note that building the app will take quite some time (>10 minutes) on the first
attempt. The build process will speed up significantly on later builds, as
dependencies and different stages of the build process will be cached.

You may need to stop and restart the Table Editor on your first run to get the
services correctly synchronized. To do so, run the following commands from the
repository root:

```
docker compose down
docker compose up --build -d
```

### Using the Table Editor

To use the Table Editor locally, open your browser to http://localhost:8080. If
you want to use https, go to https://localhost:4430 instead.

You can replace the default http port number (8080) by setting the environment
variable TABLE\_EDITOR\_HTTP\_PORT, either in your .env file or directly in your
shell by running the following command:

```
export TABLE_EDITOR_HTTP_PORT=<port number>
```

To replace the default https port number (4430), set the value of the variable
TABLE\_EDITOR\_HTTPS\_PORT.

### Stopping the Table Editor

To stop the Table Editor, run the following command from the repository root
directory:

```
docker compose down
```

## Architecture Overview

The Table Editor is built as a modular monolith, composed of several services
which are built and orchestrated using Docker. In summary, the services are:

- Frontend: The Single-Page app through which users primarily interact with the
  Table Editor. Built in React.
- REST API: The API which acts as an intermediary between the frontend and the
  database, enabling essential functionalities such as authentication and CRUD
  operations. Built in Java with Spring Boot.
- Web Socket Server: The service which provides users with real time interaction
  via web socket connections. Built in Rust with tokio.
- Reverse Proxy: A proxy which routes requests to other services through a
  common interface. Built with nginx.
- Database: Stores persistent data, including user account data and tables.
  Built in PostgreSQL.

## License

See [LICENSE](./LICENSE).
